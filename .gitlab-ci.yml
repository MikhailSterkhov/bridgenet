stages:
  - build
  - test
cache:
  paths:
    - $CI_PROJECT_DIR/.m2/repository

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=$CI_PROJECT_DIR/.m2/repository"

build:
  image: maven:3-jdk-8
  stage: build
  interruptible: true
  tags:
    - $CI_RUNNER_TAG
  script: /bin/bash bridgenet build
  artifacts:
    when: always
    expire_in: 5 days
    paths:
      - $CI_PROJECT_DIR/*
test:
  image: maven:3-jdk-8
  stage: test
  interruptible: true
  tags:
    - $CI_RUNNER_TAG
  dependencies:
    - build
  script: |-
    cd test-engine
    mvn test